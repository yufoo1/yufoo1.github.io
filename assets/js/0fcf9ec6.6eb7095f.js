"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[9367],{3905:(e,n,t)=>{t.d(n,{Zo:()=>d,kt:()=>k});var o=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=o.createContext({}),p=function(e){var n=o.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},d=function(e){var n=p(e.components);return o.createElement(s.Provider,{value:n},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},m=o.forwardRef((function(e,n){var t=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),u=p(t),m=r,k=u["".concat(s,".").concat(m)]||u[m]||c[m]||a;return t?o.createElement(k,l(l({ref:n},d),{},{components:t})):o.createElement(k,l({ref:n},d))}));function k(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var a=t.length,l=new Array(a);l[0]=m;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i[u]="string"==typeof e?e:r,l[1]=i;for(var p=2;p<a;p++)l[p]=t[p];return o.createElement.apply(null,l)}return o.createElement.apply(null,t)}m.displayName="MDXCreateElement"},994:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>p});var o=t(7462),r=(t(7294),t(3905));const a={sidebar_position:1},l="Deploy Your Own Website Database and OSS on the Server",i={unversionedId:"web-app-development/Deploy Your Own Website and Database on the Server",id:"web-app-development/Deploy Your Own Website and Database on the Server",title:"Deploy Your Own Website Database and OSS on the Server",description:"Through this article, you'll learn how to deploy a website simply. This article takes Vue, Gin, MySQL, and MongoDB as examples. Other frameworks and databases take a similar approach.",source:"@site/docs/web-app-development/Deploy Your Own Website and Database on the Server.md",sourceDirName:"web-app-development",slug:"/web-app-development/Deploy Your Own Website and Database on the Server",permalink:"/docs/web-app-development/Deploy Your Own Website and Database on the Server",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/web-app-development/Deploy Your Own Website and Database on the Server.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Web/App Development",permalink:"/docs/category/webapp-development"},next:{title:"Set Up Personal Site and Deploy Through GitHub",permalink:"/docs/web-app-development/Set Up Personal Site and Deploy Through GitHub"}},s={},p=[{value:"Deployment of MySQL",id:"deployment-of-mysql",level:2},{value:"Deployment of MongoDB",id:"deployment-of-mongodb",level:2},{value:"Deployment of Backend",id:"deployment-of-backend",level:2},{value:"Deployment of Frontend",id:"deployment-of-frontend",level:2},{value:"Deployment of MinIO",id:"deployment-of-minio",level:2},{value:"Q&amp;A",id:"qa",level:2},{value:"Docker Failed to Pull Image",id:"docker-failed-to-pull-image",level:3},{value:"Port Inaccessible",id:"port-inaccessible",level:3}],d={toc:p};function u(e){let{components:n,...a}=e;return(0,r.kt)("wrapper",(0,o.Z)({},d,a,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"deploy-your-own-website-database-and-oss-on-the-server"},"Deploy Your Own Website Database and OSS on the Server"),(0,r.kt)("p",null,"Through this article, you'll learn how to deploy a website simply. This article takes ",(0,r.kt)("inlineCode",{parentName:"p"},"Vue"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Gin"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"MySQL"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"MongoDB")," as examples. Other frameworks and databases take a similar approach."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"My server is from Ali Could and ubuntu 22.04 system.")),(0,r.kt)("h2",{id:"deployment-of-mysql"},"Deployment of MySQL"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Connect to the server through ssh remotely\uff0cthen download ",(0,r.kt)("inlineCode",{parentName:"li"},"docker"),".")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Pull the MySQL image.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"docker pull mysql\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Run image of MySQL in docker and enable remote service.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# Run img of mysql in docker\ndocker run --name NAME OF CONTAINER -d -p HOST PORT:CONTAINER PORT -e MYSQL_ROOT_PASSWORD=PASSWORD mysql\n# Check whether docker starts and corresponding container ID\ndocker ps\n# Enter docker\ndocker exec -it CONTAINER ID /bin/bash\n# Login MySQL\nmysql -u root -p\n# Type password\n# Switch database\nuse NAME OF DATABASE\n# Query the users in the database, database can be connect remotely when exists user: root, host: %\nselect user,host from mysql.user;\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"You can eonnect to MySQL from an external server via DataGrip.")),(0,r.kt)("h2",{id:"deployment-of-mongodb"},"Deployment of MongoDB"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'docker pull mongo\ndocker run -itd --name NAME OF CONTAINER -p HOST PORT:CONTAINER PORT --auth mongo\n# Enter mongo shell\nmongo\nuse admin\ndb.createUser({user:"USERNAME",pwd:"PASSWORD",roles:[  {role:"root", db:"admin" } ]})\n\ndb.auth("USERNAME","PASSWORD")\n\nuse NAME OF DATABASE\ndb.createUser({user:"USERNAME", pwd:"PASSWORD,roles:[{role:"readWrite",db:"NAME OF DATABASE"},"readWrite"]})\ndb.createCollection("NAME OF COLLECTION")\n\n# Refer to https://stackoverflow.com/questions/66719861/unable-to-authenticate-with-mongodb-golang-driver when happens \'connection() error occurred during connection handshake\'\n')),(0,r.kt)("h2",{id:"deployment-of-backend"},"Deployment of Backend"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Cross compile and package the backend.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build .\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"If you cannot download dependencies due to without configuring agent, you can upload all dependencies of backend projects locally through 'scp'. The upload directory is ' /root/go/pkg/mod' of the server.")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Write ",(0,r.kt)("inlineCode",{parentName:"li"},"Dockerfile"),".")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-dockerfile"},'# Pull img\nFROM ubuntu:22.04\n# Create Directory, can be ignored\nRUN mkdir /build\n# Set working directory\nWORKDIR /build\n# Copy the project to the corresponding directory in docker\nCOPY NAME OF PACKAGED PROJECT /build/NAME OF PROJECT\n# EXPOSE PORT\nEXPOSE EXPOSED PORT\n# Run the project directly when docker starts up\nENTRYPOINT ["./NAME OF PROJECT"]\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Generate docker image.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"docker build -t NAME OF IMAGE .\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Run image in docker.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"docker run --name NAME OF CONTAINER -d -p HOST PORT:CONTAINER PORT NAME OF IMAGE\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Check whether docker starts up\u3002")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"docker ps\n")),(0,r.kt)("h2",{id:"deployment-of-frontend"},"Deployment of Frontend"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Package the project, you can choose to package locally or on the server.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"npm run build\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Place the ",(0,r.kt)("inlineCode",{parentName:"p"},"dist")," folder on a specific path.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Configure nginx."))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# install nginx\nsudo apt-get install nginx\n\n# Modify nginx configuration file, add one more server as follows\nserver {\n                listen PORT LISTENED BY NGINX;\n                root PATH OF DIST PATh;\n                location / {\n                }\n\n        }\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Start the nginx service")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# start nginx service\nnginx\n\n# reload nginx service\nnginx -s reload\n")),(0,r.kt)("h2",{id:"deployment-of-minio"},"Deployment of MinIO"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Set up MinIO on the server.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'docker pull minio/minio\n\ndocker run \\\n    -p 9000:9000 -p 9090:9090 \\\n    -d \\\n    -e "MINIO_ACCESS_KEY=ACCOUNT" -e "MINIO_SECRET_KEY=PASSWORD" \\\n    -v /home/minio/data:/data -v /home/minio/config:/root/.minio \\\n    minio/minio server /data \\\n    --console-address ":9090" -address ":9000"\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Access MinIO on your server externally, through ",(0,r.kt)("inlineCode",{parentName:"li"},"PUBLIC IP ADDRESS OF SERVER:9090"),".")),(0,r.kt)("p",null,(0,r.kt)("img",{src:t(9097).Z,width:"3306",height:"1840"})),(0,r.kt)("h2",{id:"qa"},"Q&A"),(0,r.kt)("h3",{id:"docker-failed-to-pull-image"},"Docker Failed to Pull Image"),(0,r.kt)("p",null,"Take MySQL as an example. If you use ",(0,r.kt)("inlineCode",{parentName:"p"},"docker pull mysql")," to pull image of MySQL and the following error occurs:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'Error response from daemon: Head "https://registry-1.docker.io/v2/library/mysql/manifests/latest": net/http: TLS handshake timeout\n')),(0,r.kt)("p",null,"You can solve this problem by configuring the daemon.json, which is on '/etc/docker/daemon.json'. The specific modification is as follows"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'# daemon.json\n{\n "registry-mirrors":["MIRROR IMAGE SOURCE"]\n}\n')),(0,r.kt)("p",null,"Then, reload service by:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl daemon-reload\nsystemctl restart docker\n")),(0,r.kt)("p",null,"Just pull it again."),(0,r.kt)("h3",{id:"port-inaccessible"},"Port Inaccessible"),(0,r.kt)("p",null,"Ali Cloud has its own port opening policy. By default, only 22 and 3389 are released. If you need to release some ports, you need to set the security group of the corresponding server on Ali Cloud platform."),(0,r.kt)("p",null,(0,r.kt)("img",{src:t(5841).Z,width:"1556",height:"226"})))}u.isMDXComponent=!0},9097:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/4-666d51dc5f4fed9c84707dbf953e812f.jpg"},5841:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/5-bdd37d62c64f90fb05c6718f6b092e88.jpg"}}]);